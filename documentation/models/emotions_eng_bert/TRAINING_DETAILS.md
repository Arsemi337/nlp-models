# Training details

All the trainings are fine-tuning of ***bert-base-uncased*** or ***distilbert-base-uncased*** model. The used dataset is available in the [dataset .pkl file](../../../data/dair-ai-emotions/merged_training.pkl). Originally it consists of 416809 data samples.

| Training no. | Data samples | Train set % | Val set % | Test set % | Batch size | Epochs | Best epoch |         Fitting time         | Train accuracy | Train loss | Val accuracy | Val loss | Test accuracy | Test loss |               Accuracy figure               |                                                     Notes                                                     |
|:------------:|:------------:|:-----------:|:---------:|:----------:|:----------:|:------:|:----------:|:----------------------------:|:--------------:|:----------:|:------------:|:--------:|:-------------:|:---------:|:-------------------------------------------:|:-------------------------------------------------------------------------------------------------------------:|
|      1       |     40k      |     80%     |    10%    |    10%     |     16     |   10   |     5      | 20min 40s (***RTX 3070Ti***) |     0.9470     |   0.0882   |    0.9388    |  0.1089  |    0.9400     |  0.1220   | [figure](./figures/training_1_accuracy.png) |                                                   Ok result                                                   |
|      2       |     10k      |     80%     |    10%    |    10%     |     16     |   10   |     3      | 4min 34s (***RTX 3070Ti***)  |     0.9524     |   0.1111   |    0.9310    |  0.1696  |    0.9130     |  0.2452   | [figure](./figures/training_2_accuracy.png) |                                                 Model overfit                                                 |
|      3       |     10k      |     80%     |    10%    |    10%     |     16     |   10   |     3      | 3min 56s (***RTX 3070Ti***)  |     0.9511     |   0.1159   |    0.9320    |  0.1516  |    0.9090     |  0.2370   | [figure](./figures/training_3_accuracy.png) |                     A little bit worse performance for a little bit reduced fitting time                      |
|      4       |     40k      |     80%     |    10%    |    10%     |     16     |   10   |     1      | 24min 24s (***RTX 3070Ti***) |     0.9473     |   0.1370   |    0.9495    |  0.1301  |    0.9383     |  0.1777   | [figure](./figures/training_4_accuracy.png) | Equalized classes results in similar performance (assuming accuracy was not misleading in previous trainings) |
